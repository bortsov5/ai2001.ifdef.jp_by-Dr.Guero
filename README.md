Прошло 14 лет и автор опубликовал свой код. \n
Мне всегда было интересно как это работает.
