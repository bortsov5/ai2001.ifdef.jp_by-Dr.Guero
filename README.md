Прошло 14 лет и автор опубликовал свой код. 
<br>
Мне всегда было интересно как это работает.
